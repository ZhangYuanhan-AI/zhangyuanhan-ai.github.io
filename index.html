<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="David_Zhang">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="David_Zhang">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="David_Zhang">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>David_Zhang</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">David_Zhang</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/17/Global-Average-Pooling-and-depthwise-convolution/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Yuanhan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="David_Zhang">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/17/Global-Average-Pooling-and-depthwise-convolution/" itemprop="url">Global Average Pooling and depthwise convolution</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-17T15:30:56+08:00">
                2019-09-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Deep-Trick/" itemprop="url" rel="index">
                    <span itemprop="name">Deep Trick</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/09/17/Global-Average-Pooling-and-depthwise-convolution/" class="leancloud_visitors" data-flag-title="Global Average Pooling and depthwise convolution">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Depthwise-Convolution"><a href="#Depthwise-Convolution" class="headerlink" title="Depthwise Convolution"></a>Depthwise Convolution</h1><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://www.cnblogs.com/shine-lee/p/10243114.html" target="_blank" rel="noopener">https://www.cnblogs.com/shine-lee/p/10243114.html</a></p>
<p><a href="https://yinguobing.com/separable-convolution/" target="_blank" rel="noopener">https://yinguobing.com/separable-convolution/</a></p>
<h2 id="Highlight"><a href="#Highlight" class="headerlink" title="Highlight"></a>Highlight</h2><p>可以降低参数，加速训练</p>
<p>参考：<a href="https://yinguobing.com/separable-convolution/" target="_blank" rel="noopener">https://yinguobing.com/separable-convolution/</a></p>
<h1 id="Global-Average-Pooling"><a href="#Global-Average-Pooling" class="headerlink" title="Global Average Pooling"></a>Global Average Pooling</h1><h2 id="参考资料-1"><a href="#参考资料-1" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://www.cnblogs.com/shine-lee/p/10243114.html" target="_blank" rel="noopener">https://www.cnblogs.com/shine-lee/p/10243114.html</a></p>
<p>通过GAP得 方法取代全连接层，给GAP层赋予分类的意义，全连接层由于参数太多可能会导致过拟合，但是实验发现GAP不太实用于和人脸相关的任务；如果将Depthwise Convolutionde的思想用在GAP可以用卷积核和输入大小相同大小的卷积核来做Depthwise Convoluton来学习attention。</p>
<blockquote>
<p>更进一步，如果分组数G=N=CG=N=C，同时卷积核的尺寸与输入map的尺寸相同，即K=H=WK=H=W，则输出map为C∗1∗1C∗1∗1即长度为CC的向量，此时称之为<strong>Global Depthwise Convolution（GDC）</strong>，见<a href="https://arxiv.org/abs/1804.07573" target="_blank" rel="noopener">MobileFaceNet</a>，可以看成是<strong>全局加权池化</strong>，与 <strong>Global Average Pooling（GAP）</strong> 的不同之处在于，GDC <strong>给每个位置赋予了可学习的权重</strong>（对于已对齐的图像这很有效，比如人脸，中心位置和边界位置的权重自然应该不同），而GAP每个位置的权重相同，全局取个平均。</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/02/EM-algorithm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Yuanhan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="David_Zhang">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/02/EM-algorithm/" itemprop="url">EM algorithm</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-02T15:49:06+08:00">
                2019-09-02
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/09/02/EM-algorithm/" class="leancloud_visitors" data-flag-title="EM algorithm">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="EM-algorithm"><a href="#EM-algorithm" class="headerlink" title="EM algorithm"></a>EM algorithm</h1><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><p><a href="https://www.bilibili.com/video/av24989947" target="_blank" rel="noopener">https://www.bilibili.com/video/av24989947</a>   <a href="https://www.bilibili.com/video/av25304979/" target="_blank" rel="noopener">https://www.bilibili.com/video/av25304979/</a>：简单入门了EM</p>
</li>
<li><p><a href="https://blog.csdn.net/zouxy09/article/details/8537620" target="_blank" rel="noopener">https://blog.csdn.net/zouxy09/article/details/8537620</a> ：理解EM算法原理</p>
</li>
<li><p><a href="https://www.cnblogs.com/jerrylead/archive/2011/04/06/2006936.html" target="_blank" rel="noopener">https://www.cnblogs.com/jerrylead/archive/2011/04/06/2006936.html</a> ：理解EM算法原理</p>
</li>
</ol>
<h2 id="EM-推导"><a href="#EM-推导" class="headerlink" title="EM 推导"></a>EM 推导</h2><p>给定的训练样本是<a href="http://images.cnblogs.com/cnblogs_com/jerrylead/201104/201104061615579515.png" target="_blank" rel="noopener"><img src="https://images.cnblogs.com/cnblogs_com/jerrylead/201104/201104061615576168.png" alt="clip_image023"></a>，样例间独立，我们想找到每个样例隐含的类别z，能使得p(x,z)最大。p(x,z)的最大似然估计如下：</p>
<p>​      <a href="http://images.cnblogs.com/cnblogs_com/jerrylead/201104/201104061615582613.png" target="_blank" rel="noopener"><img src="https://images.cnblogs.com/cnblogs_com/jerrylead/201104/20110406161558694.png" alt="clip_image024"></a></p>
<blockquote>
<p>这里我们引入一些实际的例子：</p>
<ol>
<li><p>有一排球，其中球的类别有黄，蓝两种球分布在一维水平面上，每个球的分布都是高斯分布如图：</p>
<p><img src="https://i.loli.net/2019/09/02/wEFbBGuqDSTceli.png" alt="彩色球.png">，但是实际上，我们不知道哪些球是黄色，哪些球是蓝色，EM算法要做的就是在只知道有两种类型球（但是不知道哪些球是黄色，哪些球是蓝色）的基础上，估计这两种类型球的高斯分布。从而得到以下模型：<img src="https://i.loli.net/2019/09/02/EHai4QbYhVe1qKJ.png" alt="分布.png">。</p>
</li>
</ol>
</blockquote>
<p>我们想做的就是找到适合的θ和z让L(θ)最大。</p>
<p><img src="https://img-my.csdn.net/uploads/201301/24/1359004165_6698.jpg" alt="img"></p>
<p>关于2-3的推到详见参考2，3,其中$Q_i(Z^{i})​$准确的来说应该写为$Q_i(Z^{i}_j)​$指的是当前第$i​$样本，对于第$j​$类的概率，那么又有如下问题：</p>
<ol>
<li><p>为什么在（2）式不直接对$z^{i},\theta​$求导呢？：因为（2）式求导后形式会非常复杂（自己可以想象下log(f1(x)+ f2(x)+ f3(x)+…)复合函数的求导）。</p>
</li>
<li><p>（3）式只是$l(\theta)​$的下界，不能代表$l(\theta)​$，那怎么求得出argmax？：现在我们就需要一点想象力了，上面的式（2）和式（3）不等式可以写成：似然函数L(θ)&gt;=J(z,Q)，那么我们可以通过不断的最大化这个下界J，来使得L(θ)不断提高，最终达到它的最大值。，假设我们这个时候已经取到了J(z,Q)的最大值，那么让等式成立就行了，那如果对于当前的$\theta​$，J(z,Q)怎样才能取到最大值呢？–就是让当前$\theta​$下的不等式成立。</p>
<blockquote>
<p> 首先第一个问题，在Jensen不等式中说到，当自变量X是常数的时候，等式成立。而在这里，即：</p>
<p><img src="https://img-my.csdn.net/uploads/201301/24/1359004517_4140.jpg" alt="img"></p>
<p>再推导下，由于<img src="https://img-my.csdn.net/uploads/201301/24/1359004538_8410.jpg" alt="img">（因为Q是随机变量z(i)的概率密度函数），则可以得到：分子的和等于c（分子分母都对所有z(i)求和：多个等式分子分母相加不变，这个认为每个样例的两个概率比值都是c），则：</p>
<p><img src="https://img-my.csdn.net/uploads/201301/24/1359004651_3922.jpg" alt="img"></p>
<p>其中$p(z^{i} | x^{i};\theta) = \frac{p( x^{i};\theta) | z^{i})}{\sum p( x^{i};\theta) }$  bayes公式，我们用上面的蓝黄球来举例子：$p(z^{i} | x^{i};\theta)$的意思就是，当前$\theta$下第$i$个球为黄/蓝球的概率，$p( x^{i};\theta | z^{i}) $指的是：在黄/蓝球，并且在$\theta$已知的条件下，第i个球为$x^i$的概率（就这个例子来看，这个概率是一个高斯函数），分子就是所有条件概率的和了。</p>
</blockquote>
</li>
</ol>
<p>即是说当$Q_i(Z^{i})​$等于这个后验概率的时候，不等式成立，当不等式成立后，我们再更新$\theta_t​$到$\theta_{t+1}​$使得J(z,Q)变得更大，然后再让等式成立，反复迭代，知道$\theta​$的值不再发生变化。</p>
<h2 id="EM-算法流程"><a href="#EM-算法流程" class="headerlink" title="EM 算法流程"></a>EM 算法流程</h2><p><strong>重复以下步骤直到收敛</strong>：</p>
<p>​        <strong>E步骤：</strong>根据参数初始值或上一次迭代的模型参数来计算出隐性变量的后验概率，其实就是隐性变量的期望。作为隐藏变量的现估计值：</p>
<p>​       <img src="https://img-my.csdn.net/uploads/201301/24/1359004674_9261.jpg" alt="img"></p>
<p>​        <strong>M步骤：</strong>将似然函数最大化以获得新的参数值：</p>
<p>​          <img src="https://img-my.csdn.net/uploads/201301/24/1359004692_8552.jpg" alt="img"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/23/GCNet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Yuanhan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="David_Zhang">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/23/GCNet/" itemprop="url">GCNet</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-23T14:42:18+08:00">
                2019-08-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Paper-Reading/" itemprop="url" rel="index">
                    <span itemprop="name">Paper Reading</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/08/23/GCNet/" class="leancloud_visitors" data-flag-title="GCNet">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="GCNet"><a href="#GCNet" class="headerlink" title="GCNet"></a>GCNet</h1><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://zhuanlan.zhihu.com/p/64988633" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/64988633</a></p>
<h2 id="一些疑惑"><a href="#一些疑惑" class="headerlink" title="一些疑惑"></a>一些疑惑</h2><ol>
<li><p>通过严格的实验分析，作者发现non-local network的全局上下文在不同位置几乎是相同的，这表明学习到了无位置依赖的全局上下文。</p>
<ul>
<li>但是我觉得不一定的，因为对于一个feature map 大部分位置并不会有什么大的激活，所以大部分位置的att可能都相同，只有少部分位置被激活，只有这些位置的att相似，比如大部分的att都是(0,0,0,0,0,1,0,0,0,1)只有小部分的激活点的att是(1,1,1,1,1,1,0,1,1,1,0)那么平均下来当然大部分的atte相同，仅仅靠一个取平均值的说法并不可靠。<ul>
<li>进一步，我觉得层数越浅，可能att越不相似，因为浅层的信息语义比较浅，大部分位置都有激活。</li>
</ul>
</li>
</ul>
</li>
<li><p>对于simple_No_local的最后的map是1*c的解释：</p>
<blockquote>
<p>non-local block可以表示为：</p>
<p><img src="https://www.zhihu.com/equation?tex=%5Cmathbf%7Bz%7D_%7Bi%7D%3D%5Cmathbf%7Bx%7D_%7Bi%7D%2BW_%7Bz%7D+%5Csum_%7Bj%3D1%7D%5E%7BN_%7Bp%7D%7D+%5Cfrac%7Bf%5Cleft%28%5Cmathbf%7Bx%7D_%7Bi%7D%2C+%5Cmathbf%7Bx%7D_%7Bj%7D%5Cright%29%7D%7B%5Cmathcal%7BC%7D%28%5Cmathbf%7Bx%7D%29%7D%5Cleft%28W_%7Bv%7D+%5Ccdot+%5Cmathbf%7Bx%7D_%7Bj%7D%5Cright%29%5C%5C" alt="[公式]"></p>
<p><img src="https://www.zhihu.com/equation?tex=i" alt="[公式]"> 为位置的索引， <img src="https://www.zhihu.com/equation?tex=j" alt="[公式]"> 枚举所有可能的位置。 <img src="https://www.zhihu.com/equation?tex=f%5Cleft%28%5Cmathbf%7Bx%7D_%7Bi%7D%2C+%5Cmathbf%7Bx%7D_%7Bj%7D%5Cright%29" alt="[公式]"> 表示位置 <img src="https://www.zhihu.com/equation?tex=i" alt="[公式]"> 和 <img src="https://www.zhihu.com/equation?tex=j" alt="[公式]"> 的关系， <img src="https://www.zhihu.com/equation?tex=%5Cmathcal%7BC%7D%28%5Cmathbf%7Bx%7D%29" alt="[公式]"> 为归一化因子。 <img src="https://www.zhihu.com/equation?tex=W_%7Bz%7D" alt="[公式]"> 和 <img src="https://www.zhihu.com/equation?tex=W_%7Bv%7D" alt="[公式]"> 表示线性转换矩阵(例如1x1卷积)。为了简单起见，定义 <img src="https://www.zhihu.com/equation?tex=%5Comega_%7Bi+j%7D%3D%5Cfrac%7Bf%5Cleft%28%5Cmathbf%7Bx%7D_%7Bi%7D%2C+%5Cmathbf%7Bx%7D_%7Bj%7D%5Cright%29%7D%7BC%28%5Cmathbf%7Bx%7D%29%7D" alt="[公式]">为位置 <img src="https://www.zhihu.com/equation?tex=i" alt="[公式]"> 和 <img src="https://www.zhihu.com/equation?tex=j" alt="[公式]"> 的归一化关系。本文中将 <img src="https://www.zhihu.com/equation?tex=%5Comega_%7Bi+j%7D" alt="[公式]"> 表示为Embedded Gaussian的形式，定义为 <img src="https://www.zhihu.com/equation?tex=%5Comega_%7Bi+j%7D%3D%5Cfrac%7B%5Cexp+%5Cleft%28%5Cleft%5Clangle+W_%7Bq%7D+%5Cmathbf%7Bx%7D_%7Bi%7D%2C+W_%7Bk%7D+%5Cmathbf%7Bx%7D_%7Bj%7D%5Cright%5Crangle%5Cright%29%7D%7B%5Csum_%7Bm%7D+%5Cexp+%5Cleft%28%5Cleft%5Clangle+W_%7Bq%7D+%5Cmathbf%7Bx%7D_%7Bi%7D%2C+W_%7Bk%7D+%5Cmathbf%7Bx%7D_%7Bm%7D%5Cright%5Crangle%5Cright%29%7D" alt="[公式]"> 。</p>
</blockquote>
<p>如果attention都一样，那么<img src="https://www.zhihu.com/equation?tex=%5Comega_%7Bi+j%7D%3D%5Cfrac%7Bf%5Cleft%28%5Cmathbf%7Bx%7D_%7Bi%7D%2C+%5Cmathbf%7Bx%7D_%7Bj%7D%5Cright%29%7D%7BC%28%5Cmathbf%7Bx%7D%29%7D" alt="[公式]">可以直接从HW*HW的向量变成HW * 1的向量这个attention可以称为基于global的attention，进一步，后续的$W_z$之后的值也是一个对于所有position都一样的值，因为对于每个position，这个值都一样，所以一个channel只需要有一个值，最后会把这个值扩展为H * W大小,有c个channel所以有c个值。</p>
</li>
<li><p><strong>对于维度这么高的feature map只有一个attention的值合不合适？这个attention到底要怎么计算？</strong></p>
</li>
<li><p>model the global context？</p>
<blockquote>
<p>To model the global context features, SENet [14], GENet</p>
<p>[13], and PSANet [41] perform rescaling to different channels</p>
<p>to recalibrate the channel dependency with global context.</p>
<p>CBAM [32] recalibrates the importance of different</p>
<p>spatial positions and channels both via rescaling. However,</p>
<p>all these methods adopt rescaling for feature fusion which</p>
<p>is not effective enough for global context modeling.</p>
</blockquote>
<p>这个model the global context指建模的是全局信息，比如SE中的global avg pooling：</p>
<blockquote>
<p><img src="https://pic1.zhimg.com/80/v2-64e3c83d1b83d47e6238b13b373964f4_hd.jpg" alt="img"></p>
<p>SE block也可以抽象成3个步骤：</p>
<p>(a)global avg pooling用于上下文建模(即squeeze operation)。</p>
<p>(b)bottleneck transform用于计算每个通道的重要程度(即excitation operation)。</p>
<p>(c)rescaling function用于通道特征重标定(即element-wise multiplication)。</p>
</blockquote>
<p>又比如GC中的global attention pooling：</p>
<blockquote>
<p><img src="https://pic2.zhimg.com/80/v2-c9a9fd5ca99d9c3a0a3be35cc481d1b1_hd.jpg" alt="img"></p>
<p>(a)global attention pooling用于上下文建模。</p>
<ul>
<li>这部分又有两步<ol>
<li>生成attention</li>
<li>pooling</li>
</ol>
</li>
</ul>
<p>(b)bottleneck transform来捕获通道间依赖。</p>
<p>(c)broadcast element-wise addition用于特征融合。</p>
</blockquote>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/22/Attention-U-Net/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Yuanhan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="David_Zhang">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/22/Attention-U-Net/" itemprop="url">Attention U-Net</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-22T15:48:12+08:00">
                2019-08-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Paper-Reading/" itemprop="url" rel="index">
                    <span itemprop="name">Paper Reading</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/08/22/Attention-U-Net/" class="leancloud_visitors" data-flag-title="Attention U-Net">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Attention-U-Net"><a href="#Attention-U-Net" class="headerlink" title="Attention U-Net"></a>Attention U-Net</h1><p>将Attention机制应用到了 U-net</p>
<p><img src="https://i.loli.net/2019/08/22/Q9xG4NDfkK3AO6j.png" alt="Attention_U-net.png"></p>
<p><img src="https://i.loli.net/2019/08/22/wtMlr9K623cajbL.png" alt="framework.png"></p>
<p>需要注意的是，按源代码来说，这里并没有Resampler的过程。这里的$x^l$是上采样之后的图像，和$g$的大小一样。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Attention_block</span><span class="params">(nn.Module)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,F_g,F_l,F_int)</span>:</span></span><br><span class="line">        super(Attention_block,self).__init__()</span><br><span class="line">        self.W_g = nn.Sequential(</span><br><span class="line">            nn.Conv2d(F_g, F_int, kernel_size=<span class="number">1</span>,stride=<span class="number">1</span>,padding=<span class="number">0</span>,bias=<span class="literal">True</span>),</span><br><span class="line">            nn.BatchNorm2d(F_int)</span><br><span class="line">            )</span><br><span class="line">        </span><br><span class="line">        self.W_x = nn.Sequential(</span><br><span class="line">            nn.Conv2d(F_l, F_int, kernel_size=<span class="number">1</span>,stride=<span class="number">1</span>,padding=<span class="number">0</span>,bias=<span class="literal">True</span>),</span><br><span class="line">            nn.BatchNorm2d(F_int)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        self.psi = nn.Sequential(</span><br><span class="line">            nn.Conv2d(F_int, <span class="number">1</span>, kernel_size=<span class="number">1</span>,stride=<span class="number">1</span>,padding=<span class="number">0</span>,bias=<span class="literal">True</span>),</span><br><span class="line">            nn.BatchNorm2d(<span class="number">1</span>),</span><br><span class="line">            nn.Sigmoid()</span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        self.relu = nn.ReLU(inplace=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(self,g,x)</span>:</span></span><br><span class="line">        g1 = self.W_g(g)</span><br><span class="line">        x1 = self.W_x(x)</span><br><span class="line">        psi = self.relu(g1+x1)</span><br><span class="line">        psi = self.psi(psi)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> x*psi</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/15/ROI-Align/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Yuanhan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="David_Zhang">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/15/ROI-Align/" itemprop="url">ROI Align</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-15T19:28:41+08:00">
                2019-08-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Deep-Trick/" itemprop="url" rel="index">
                    <span itemprop="name">Deep Trick</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/08/15/ROI-Align/" class="leancloud_visitors" data-flag-title="ROI Align">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#ROI Align</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ol>
<li><a href="https://zhuanlan.zhihu.com/p/37998710" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/37998710</a></li>
</ol>
<blockquote>
<h2 id="ROIpooling"><a href="#ROIpooling" class="headerlink" title="ROIpooling"></a>ROIpooling</h2><p>ROI pooling就不多解释了，直接通过一个例子来形象理解。假设现在我们有一个8x8大小的feature map，我们要在这个feature map上得到ROI，并且进行ROI pooling到2x2大小的输出。</p>
<p><img src="https://pic2.zhimg.com/80/v2-17d3c689270ac638d9aafd90b96149e5_hd.jpg" alt="img"></p>
<p>假设ROI的bounding box为 <img src="https://www.zhihu.com/equation?tex=%5Bx_1%2Cy_1%2Cx_2%2Cy_2%5D%3D%5B0%2C3%2C7%2C8%5D" alt="[公式]"> 。如图：</p>
<p><img src="https://pic3.zhimg.com/80/v2-b52b7f305f1aaea6febfe0d22a7d23da_hd.jpg" alt="img"></p>
<p>将它划分为2x2的网格，因为ROI的长宽除以2是不能整除的，所以会出现每个格子大小不一样的情况。</p>
<p><img src="https://pic4.zhimg.com/80/v2-5ba9049300789586c29f78ebc2a5acb7_hd.jpg" alt="img"></p>
<p>进行max pooling的最终2x2的输出为：</p>
<p><img src="https://pic1.zhimg.com/80/v2-df2414cb2eb3ae6e3bc30b9289cf5c44_hd.jpg" alt="img"></p>
<p>最后以一张动图形象概括之：</p>
<p><img src="https://pic4.zhimg.com/v2-e55e66c9c21136efa62beacfcb02f9ef_b.gif" alt="img"></p>
<p>参考：<a href="https://link.zhihu.com/?target=https%3A//blog.deepsense.ai/region-of-interest-pooling-explained/" target="_blank" rel="noopener">Region of interest pooling explained</a></p>
<h2 id="3-ROI-Align"><a href="#3-ROI-Align" class="headerlink" title="3. ROI Align"></a>3. ROI Align</h2><p>在Faster RCNN中，有两次整数化的过程：</p>
<ol>
<li>region proposal的xywh通常是小数，但是为了方便操作会把它整数化。</li>
<li>将整数化后的边界区域平均分割成 k x k 个单元，对每一个单元的边界进行整数化。</li>
</ol>
<p>两次整数化的过程如下图所示：</p>
<p><img src="https://pic3.zhimg.com/80/v2-36e08338390289e0dd88203b4e8ddda2_hd.jpg" alt="img"></p>
<p>事实上，经过上述两次整数化，此时的候选框已经和最开始回归出来的位置有一定的偏差，这个偏差会影响检测或者分割的准确度。在论文里，作者把它总结为“不匹配问题”（misalignment）。</p>
<p>为了解决这个问题，ROI Align方法取消整数化操作，保留了小数，使用以上介绍的双线性插值的方法获得坐标为浮点数的像素点上的图像数值。但在实际操作中，ROI Align并不是简单地补充出候选区域边界上的坐标点，然后进行池化，而是重新进行设计。</p>
<p>下面通过一个例子来讲解ROI Align操作。如下图所示，虚线部分表示feature map，实线表示ROI，这里将ROI切分成2x2的单元格。如果采样点数是4，那我们首先将每个单元格子均分成四个小方格（如红色线所示），每个小方格中心就是采样点。这些采样点的坐标通常是浮点数，所以需要对采样点像素进行双线性插值（如四个箭头所示），就可以得到该像素点的值了。然后对每个单元格内的四个采样点进行maxpooling，就可以得到最终的ROIAlign的结果。</p>
<p><img src="https://pic1.zhimg.com/80/v2-76b8a15c735d560f73718581de34249c_hd.jpg" alt="img"></p>
<p>需要说明的是，在相关实验中，作者发现将采样点设为4会获得最佳性能，甚至直接设为1在性能上也相差无几。事实上，ROI Align 在遍历取样点的数量上没有ROIPooling那么多，但却可以获得更好的性能，这主要归功于解决了misalignment的问题。</p>
</blockquote>
<p>个人补充：实际上最后应该是要得到13*13的feature map 那么就要把ROI化成13个bin，注意每个bin还要划分4格，每个格子的中心是个浮点数要通过插值把其真实值插出来，然后对这4个小格子的值做最后的maxpooling得到这个bin的值。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/15/NMS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Yuanhan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="David_Zhang">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/15/NMS/" itemprop="url">NMS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-15T16:43:31+08:00">
                2019-08-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Deep-Trick/" itemprop="url" rel="index">
                    <span itemprop="name">Deep Trick</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/08/15/NMS/" class="leancloud_visitors" data-flag-title="NMS">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="NMS"><a href="#NMS" class="headerlink" title="NMS"></a>NMS</h1><p>通常来说有两种NMS</p>
<ol>
<li><p>SSD fasterRCNN</p>
<ul>
<li><p>置信度小于阈值的proposal（anchor）score都变为0</p>
</li>
<li><p>将score排序，从score最高的开始，把与当前score最高的proposal（anchor）IOU大于阈值的proposal（anchor）过滤掉，重复当前步骤知道无法继续。</p>
</li>
</ul>
</li>
<li><p>YOLO</p>
<p>每个类别都做NMS</p>
<blockquote>
<p>首先将小于置信度阈值的值归0，然后分类别地对置信度值采用NMS，这里NMS处理结果不是剔除，而是将其置信度值归为0。最后才是确定各个box的类别，当其置信度值不为0时才做出检测结果输出。</p>
</blockquote>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/15/YOLOV2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Yuanhan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="David_Zhang">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/15/YOLOV2/" itemprop="url">YOLOV2 and YOLOV3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-15T14:07:23+08:00">
                2019-08-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2019/08/15/YOLOV2/" class="leancloud_visitors" data-flag-title="YOLOV2 and YOLOV3">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="YOLOV2"><a href="#YOLOV2" class="headerlink" title="YOLOV2"></a>YOLOV2</h1><h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><ol>
<li><a href="https://zhuanlan.zhihu.com/p/35325884" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/35325884</a></li>
</ol>
<h2 id="Highlight"><a href="#Highlight" class="headerlink" title="Highlight"></a>Highlight</h2><ol>
<li><p>最后的feature map为13 * 13大小，每个bin有5个anchor，预测（x,y,w,h,confi,class）取消了YOLOv1的全连接。</p>
</li>
<li><p>引入了anchor</p>
<ul>
<li>anchor大小的设定和原图无关（SSD中anchor的大小和原图相关),anchor的计算通过Kmeans聚类(<a href="https://blog.csdn.net/huangfei711/article/details/78480078" target="_blank" rel="noopener">https://blog.csdn.net/huangfei711/article/details/78480078</a>) (聚类距离是1- IOU)训练集的GT框的大小来得到，源码中这些特征框的数值应该是对于原图的比例。</li>
<li>每个anchor都对应了一组GT（和YOLOv1不同）和（SSD）类似。</li>
</ul>
</li>
<li><p>BB的数值变成偏移量-和SSD相同</p>
</li>
<li><p>Fine-Grained Features</p>
<blockquote>
<p>YOLOv2提出了一种passthrough层来利用更精细的特征图。YOLOv2所利用的Fine-Grained Features是 <img src="https://www.zhihu.com/equation?tex=26%5Ctimes26" alt="[公式]"> 大小的特征图（最后一个maxpooling层的输入），对于Darknet-19模型来说就是大小为 <img src="https://www.zhihu.com/equation?tex=26%5Ctimes26%5Ctimes512" alt="[公式]"> 的特征图。passthrough层与ResNet网络的shortcut类似，以前面更高分辨率的特征图为输入，然后将其连接到后面的低分辨率特征图上。前面的特征图维度是后面的特征图的2倍，passthrough层抽取前面层的每个 <img src="https://www.zhihu.com/equation?tex=2%5Ctimes2" alt="[公式]"> 的局部区域，然后将其转化为channel维度，对于 <img src="https://www.zhihu.com/equation?tex=26%5Ctimes26%5Ctimes512" alt="[公式]"> 的特征图，经passthrough层处理之后就变成了 <img src="https://www.zhihu.com/equation?tex=13%5Ctimes13%5Ctimes2048" alt="[公式]"> 的新特征图（特征图大小降低4倍，而channles增加4倍，图6为一个实例），这样就可以与后面的 <img src="https://www.zhihu.com/equation?tex=13%5Ctimes13%5Ctimes1024" alt="[公式]"> 特征图连接在一起形成 <img src="https://www.zhihu.com/equation?tex=13%5Ctimes13%5Ctimes3072" alt="[公式]"> 大小的特征图，然后在此特征图基础上卷积做预测。</p>
<p><img src="https://pic3.zhimg.com/80/v2-c94c787a81c1216d8963f7c173c6f086_hd.jpg" alt="img">图6：passthrough层实例</p>
</blockquote>
</li>
<li><p>Multi-Scale Training</p>
</li>
<li><blockquote>
<p>由于YOLOv2模型中只有卷积层和池化层，所以YOLOv2的输入可以不限于 <img src="https://www.zhihu.com/equation?tex=416%5Ctimes416" alt="[公式]"> 大小的图片。为了增强模型的鲁棒性，YOLOv2采用了多尺度输入训练策略，具体来说就是在训练过程中每间隔一定的iterations之后改变模型的输入图片大小。由于YOLOv2的下采样总步长为32，输入图片大小选择一系列为32倍数的值： <img src="https://www.zhihu.com/equation?tex=%5C%7B320%2C+352%2C...%2C+608%5C%7D" alt="[公式]"> ，输入图片最小为 <img src="https://www.zhihu.com/equation?tex=320%5Ctimes320" alt="[公式]"> ，此时对应的特征图大小为 <img src="https://www.zhihu.com/equation?tex=10%5Ctimes10" alt="[公式]"> （不是奇数了，确实有点尴尬），而输入图片最大为 <img src="https://www.zhihu.com/equation?tex=608%5Ctimes608" alt="[公式]">，对应的特征图大小为 <img src="https://www.zhihu.com/equation?tex=19%5Ctimes19" alt="[公式]"> 。在训练过程，每隔10个iterations随机选择一种输入图片大小，然后只需要修改对最后检测层的处理就可以重新训练。</p>
<p><img src="https://pic2.zhimg.com/80/v2-3c72c10c00c9268091d8c93f908d90ed_hd.jpg" alt="img">图7：Multi-Scale Training</p>
<p>采用Multi-Scale Training策略，YOLOv2可以适应不同大小的图片，并且预测出很好的结果</p>
</blockquote>
</li>
<li><p>GT的选择</p>
<blockquote>
<ol>
<li>哪些预测框来预测背景呢，需要先计算各个预测框和所有ground truth的IOU值，并且取最大值Max_IOU，如果该值小于一定的阈值（YOLOv2使用的是0.6），那么这个预测框就标记为background。</li>
<li>对于某个ground truth，首先要确定其中心点要落在哪个cell上，然后计算这个cell的5个先验框与ground truth的IOU值（YOLOv2中bias_match=1），计算IOU值时不考虑坐标，<strong>只考虑形状</strong>，所以先将先验框与ground truth的中心点都偏移到同一位置（原点），然后计算出对应的IOU值，IOU值最大的那个先验框与ground truth匹配，对应的预测框用来预测这个ground truth。（不同于SSD，YOLOV2一个GT只和一个anchor匹配）。</li>
<li>对于那些没有与ground truth匹配的先验框（与预测框对应），除去那些Max_IOU低于阈值的（变成background），其它的就全部忽略，不计算任何误差。（不计算，中间不计算和fasterRCNN有点像，但是fasterRCNN一个GT可以对应多个anchor，重合的anchor在proposa到后面head的时候通过NMS除掉）</li>
</ol>
</blockquote>
</li>
</ol>
<h1 id="YOLOV3"><a href="#YOLOV3" class="headerlink" title="YOLOV3"></a>YOLOV3</h1><h2 id="Highlight-1"><a href="#Highlight-1" class="headerlink" title="Highlight"></a>Highlight</h2><p>加上了FPN和Resnet</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/15/Focal-Loss/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Yuanhan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="David_Zhang">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/15/Focal-Loss/" itemprop="url">Focal Loss</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-15T12:02:01+08:00">
                2019-08-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Deep-Trick/" itemprop="url" rel="index">
                    <span itemprop="name">Deep Trick</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/08/15/Focal-Loss/" class="leancloud_visitors" data-flag-title="Focal Loss">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Focal-Loss"><a href="#Focal-Loss" class="headerlink" title="Focal Loss"></a>Focal Loss</h1><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><a href="https://zhuanlan.zhihu.com/p/32423092" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/32423092</a></p>
<p>这篇文章特别清晰的解释了Focal Loss的推导。</p>
<p>中心思想：</p>
<ol>
<li>让网络集中力量训练不好训练的部分。</li>
<li>关于$\gamma$ 的大小对结果的影响（旷视面试的时候被que到）：<ul>
<li>当$\gamma$ = 0的时候，focal loss 变成softmax</li>
<li>当$\gamma$ &gt; 0 的时候，$\gamma$越大，容易区分的样本给loss的贡献越少，所以$\gamma$有点像容易区分样本的权重。</li>
</ul>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/14/Random-Forest/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Yuanhan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="David_Zhang">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/14/Random-Forest/" itemprop="url">Random Forest</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-14T14:43:49+08:00">
                2019-08-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/08/14/Random-Forest/" class="leancloud_visitors" data-flag-title="Random Forest">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Random-Forest"><a href="#Random-Forest" class="headerlink" title="Random Forest"></a>Random Forest</h1><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><a href="https://zhuanlan.zhihu.com/p/34534004" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/34534004</a></p>
<h2 id="Highlight"><a href="#Highlight" class="headerlink" title="Highlight"></a>Highlight</h2><ol>
<li><p>数据的随机选取</p>
<blockquote>
<p>从原始的数据集中采取<strong>有放回的抽样</strong>（bootstrap），构造子数据集，子数据集的数据量是和原始数据集相同的。不同子数据集的元素可以重复，同一个子数据集中的元素也可以重复。</p>
</blockquote>
<blockquote>
<p>利用子数据集来构建子决策树，将这个数据放到每个子决策树中，每个子决策树输出一个结果。最后，如果有了新的数据需要通过随机森林得到分类结果，就可以通过对子决策树的判断结果的投票，得到随机森林的输出结果了。如下图，假设随机森林中有3棵子决策树，2棵子树的分类结果是A类，1棵子树的分类结果是B类，那么随机森林的分类结果就是A类。</p>
</blockquote>
<p><img src="https://i.loli.net/2019/08/14/HxKNg6ewJha1q72.jpg" alt="123321.jpg"></p>
</li>
<li><p>待选特征的随机选取</p>
<blockquote>
<p>与数据集的随机选取类似，随机森林中的子树的每一个分裂过程并未用到所有的待选特征，而是从所有的待选特征中随机选取一定的特征，之后再在随机选取的特征中选取最优的特征。这样能够使得随机森林中的决策树都能够彼此不同，提升系统的多样性，从而提升分类性能。</p>
</blockquote>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/14/Decision-Tree/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Yuanhan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="David_Zhang">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/14/Decision-Tree/" itemprop="url">Decision Tree</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-14T14:43:36+08:00">
                2019-08-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/08/14/Decision-Tree/" class="leancloud_visitors" data-flag-title="Decision Tree">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Decision-Tree"><a href="#Decision-Tree" class="headerlink" title="Decision Tree"></a>Decision Tree</h1><h2 id="回归树"><a href="#回归树" class="headerlink" title="回归树"></a>回归树</h2><h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><p><a href="https://blog.csdn.net/weixin_40604987/article/details/79296427" target="_blank" rel="noopener">https://blog.csdn.net/weixin_40604987/article/details/79296427</a></p>
<h3 id="划分分裂的方法"><a href="#划分分裂的方法" class="headerlink" title="划分分裂的方法"></a>划分分裂的方法</h3><ol>
<li><p>最小二乘法分裂</p>
<ul>
<li><p>决定一个属性</p>
</li>
<li><p>基于该属性决定切分点</p>
</li>
<li><p>通过切分点左右区域分别计算y的均值c1,c2（这个时候y的取值有很多，不只是0，1）</p>
</li>
<li><p>算两个区域每个y（y1,y2,y2…yn）值和自己区域均值(c1/c2)的平方差的和</p>
</li>
<li><p>把最小平方差对应的切分点作为当前切分点。</p>
</li>
</ul>
</li>
</ol>
<h2 id="分类树"><a href="#分类树" class="headerlink" title="分类树"></a>分类树</h2><h3 id="参考文献-1"><a href="#参考文献-1" class="headerlink" title="参考文献"></a>参考文献</h3><ol>
<li><a href="https://zhuanlan.zhihu.com/p/26703300" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/26703300</a></li>
</ol>
<h3 id="Structure"><a href="#Structure" class="headerlink" title="Structure"></a>Structure</h3><p><img src="https://i.loli.net/2019/08/14/ASu16D9PMYIeQ7r.png" alt="决策树_西瓜.png"></p>
<p><img src="https://i.loli.net/2019/08/14/6tWgncNL7xZkI1j.png" alt="西瓜_结果.png"></p>
<p>根据每个属性和纯度的关系求出当前的分裂属性</p>
<blockquote>
<p>所谓分裂属性就是在某个节点处按照某一特征属性的不同划分构造不同的分支，其目标是让各个分裂子集尽可能地“纯”。尽可能“纯”就是尽量让一个分裂子集中待分类项属于同一类别。<strong>而判断“纯”的方法不同引出了我们的ID3算法，C4.5算法以及CART算法</strong>–<a href="https://zhuanlan.zhihu.com/p/26760551" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/26760551</a></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Zhang Yuanhan</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">26</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhang Yuanhan</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("GxkhTbMmcwkcQBiHFSVpjeJV", "u2grDKr3jJbwNHoKnA7lWj3l");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

</body>
</html>
